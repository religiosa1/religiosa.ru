<!DOCTYPE html><html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><title>Личные заметки и всякая всячина - Тестовый сервер express</title><link rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="stylesheet" href="/style/global.css"><link rel="stylesheet" href="/style/prism-vsc-dark-plus.css"><link rel="stylesheet" href="/_astro/common-bMouB.css" type="text/css"></head><body class="main-grid"><header class="main-grid__header astro-HaDR30LO"><a href="/" class="moto-link astro-HaDR30LO"><h1 class="moto astro-HaDR30LO">Личные заметки и всякая всячина.</h1></a></header><main class="main-grid__main astro-HaDR30LO"><h2 class="astro-T9ouf1IY">Тестовый сервер express</h2><nav class="breadcrumbs astro-Iv2DiwOJ"><a href="/" class="breadcrubmbs-link astro-N3k3AXB7">Главная страница</a><a href="/programming/" class="breadcrubmbs-link astro-N3k3AXB7">Программирование</a><span class="breadcrumbs__current astro-Iv2DiwOJ">Тестовый сервер express</span></nav><article class="md-content astro-T9ouf1IY"><p>Простенький сервер-express, чтобы можно было проверять работу ajax-запросов.</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">[</span>
  <span class="token comment">// Здесь статика отдаваемая от корня</span>
  <span class="token string">'css'</span><span class="token punctuation">,</span>
  <span class="token string">'js'</span><span class="token punctuation">,</span>
  <span class="token string">'media'</span><span class="token punctuation">,</span>
  <span class="token string">'img'</span><span class="token punctuation">,</span>
  <span class="token string">'fonts'</span>
<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span> <span class="token string">'/'</span><span class="token operator">+</span>item<span class="token punctuation">,</span> express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Serving static: '</span><span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Сюда можно подложить статические json-файлы, для эмуляции api</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/api'</span><span class="token punctuation">,</span> express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span><span class="token string">"api"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>extensions<span class="token operator">:</span><span class="token string">"json"</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Эмуляция post-запроса</span>
app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/api/filter'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span><span class="token string">'api/filter.json'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> root<span class="token operator">:</span> __dirname<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Тут просто отдаем html-ку</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> root<span class="token operator">:</span> __dirname<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'App listening on http://127.0.0.1:3000/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></article></main><footer class="main-grid__footer astro-HaDR30LO"><a href="https://github.com/religiosa1/religiosa1.github.io" class="github-link astro-HaDR30LO">
      Исходный код
    </a></footer></body></html>